# üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Web App

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è Telegram Web Apps

### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**Telegram Web Apps (TWA)** ‚Äî —ç—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ Telegram —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

1. **–û—Ç–∫—Ä—ã–≤–∞—Ç—å —Å–∞–π—Ç –ø–æ –∫–Ω–æ–ø–∫–µ –≤ –±–æ—Ç–µ** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ, –∏ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Telegram
2. **–î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Telegram (–∏–º—è, username, ID)
3. **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º** ‚Äî –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ –±–æ—Ç—É
4. **–ù–∞—Ç–∏–≤–Ω—ã–π –≤–∏–¥** ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —á–∞—Å—Ç—å Telegram

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ ‚Üí Telegram –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Web App ‚Üí 
‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É ‚Üí –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä ‚Üí 
‚Üí –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —á–µ—Ä–µ–∑ Bot API
```

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –≠—Ç–∞–ø 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞
1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –ü–æ–ª—É—á–∏—Ç—å Bot Token
3. –°–æ–∑–¥–∞—Ç—å Web App –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω –¥–ª—è Web App

### –≠—Ç–∞–ø 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram Web App SDK (Frontend)
1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `@twa-dev/sdk` (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å SDK –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
3. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
4. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å UI –ø–æ–¥ Telegram

### –≠—Ç–∞–ø 3: Backend –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
1. –°–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Telegram Bot API
3. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º—ã

### –≠—Ç–∞–ø 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã
1. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ backend
2. Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
3. –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Telegram Bot API

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥:
```
POST https://api.telegram.org/bot<TOKEN>/sendMessage
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

```json
{
  "chat_id": "ADMIN_CHAT_ID",
  "text": "üìù –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –æ–±–º–µ–Ω\n\nüë§ –ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (999) 123-45-67\nüí∞ –°—É–º–º–∞: 100 USDT\nüíµ –ö –ø–æ–ª—É—á–µ–Ω–∏—é: 10,000 RUB\nüí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞\nüí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ...",
  "parse_mode": "HTML"
}
```

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, —Å–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ **Bot Token** (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ Web App –∫–Ω–æ–ø–∫–∏

–í @BotFather:
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newapp`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Currency Exchange")
4. –£–∫–∞–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã USDT/RUB")
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∫–æ–Ω–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
6. –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://yourdomain.com` –∏–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `https://yourdomain.ngrok.io`)
7. –ü–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤–∏–¥–∞: `https://t.me/your_bot/app`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ):**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/setmenubutton` –≤ @BotFather
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –£–∫–∞–∂–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "üí± –û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã")
4. –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Chat ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–°–ø–æ—Å–æ–± 1 (—á–µ—Ä–µ–∑ getUpdates):**
1. –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ–º—É –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":123456789}` ‚Äî —ç—Ç–æ –≤–∞—à Chat ID

**–°–ø–æ—Å–æ–± 2 (—á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞):**
1. –ù–∞–ø–∏—à–∏—Ç–µ [@userinfobot](https://t.me/userinfobot) –≤ Telegram
2. –û–Ω –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à Chat ID

**–°–ø–æ—Å–æ–± 3 (–¥–ª—è –≥—Ä—É–ø–ø):**
1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
4. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":-123456789}` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è –≥—Ä—É–ø–ø)

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Backend `.env` (—Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `backend/`):**
```env
# Server Configuration
PORT=3000
HOST=localhost

# API Configuration
RAPIRA_API_URL=https://api.rapira.net/open/market/rates

# Data Storage
ORDERS_FILE=./data/orders.json

# Telegram Bot Configuration
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_ADMIN_CHAT_ID=123456789
```

**Frontend `.env.local` (—Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `frontend/`):**
```env
VITE_API_URL=http://localhost:3000
```

### 5. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ª–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Web App –ª–æ–∫–∞–ª—å–Ω–æ, –≤–∞–º –Ω—É–∂–Ω–æ:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å:**
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok
   ngrok http 5173  # –¥–ª—è frontend (Vite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   ngrok http 3000  # –¥–ª—è backend
   ```

2. **–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å:**
   - [localtunnel](https://localtunnel.github.io/www/)
   - [serveo](https://serveo.net/)

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ URL –≤ @BotFather:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok URL –¥–ª—è Web App
   - –ù–∞–ø—Ä–∏–º–µ—Ä: `https://abc123.ngrok.io`

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend:
   ```bash
   cd backend
   npm start
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ frontend:
   ```bash
   cd frontend
   npm run dev
   ```

3. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É Web App

4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É

5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram

## üì± –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Telegram Web App

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ SDK:

- `window.Telegram.WebApp.initData` ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `window.Telegram.WebApp.ready()` ‚Äî –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `window.Telegram.WebApp.expand()` ‚Äî —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
- `window.Telegram.WebApp.close()` ‚Äî –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `window.Telegram.WebApp.sendData()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
- `window.Telegram.WebApp.MainButton` ‚Äî –∫–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞

### –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```javascript
const user = window.Telegram.WebApp.initDataUnsafe?.user
// {
//   id: 123456789,
//   first_name: "–ò–≤–∞–Ω",
//   last_name: "–ò–≤–∞–Ω–æ–≤",
//   username: "ivanov",
//   language_code: "ru"
// }
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ Bot Token –≤ –∫–æ–¥–µ frontend
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Bot API –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ backend
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `initData` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è production

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Telegram Bot API Documentation](https://core.telegram.org/bots/api)
- [Telegram Web Apps Documentation](https://core.telegram.org/bots/webapps)
- [@twa-dev/sdk GitHub](https://github.com/twa-dev/sdk)

